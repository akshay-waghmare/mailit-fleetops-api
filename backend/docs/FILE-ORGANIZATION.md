# 📁 File Organization - Bulk Order Upload

## Overview
This document describes the organization of files related to the bulk order upload feature.

## Directory Structure

```
backend/
├── docs/                           # Documentation
│   ├── BULK-UPLOAD-NEXT-STEPS.md  # Phase 3 planning
│   ├── MANUAL-TESTING-GUIDE.md    # Testing guide
│   └── FILE-ORGANIZATION.md       # This file
│
├── scripts/                        # Node.js testing scripts
│   ├── README.md                  # Scripts documentation
│   ├── generate-test-excel.js     # Excel test file generator
│   └── test-upload.js             # API testing client
│
├── test-data/                      # Generated test files (gitignored)
│   ├── .gitkeep                   # Keep directory in git
│   ├── test-orders.xlsx           # 3-row test file (ignored)
│   └── test-new.xlsx              # Fresh test file (ignored)
│
├── src/
│   ├── main/
│   │   ├── java/com/fleetops/bulkupload/
│   │   │   ├── controller/        # REST controllers
│   │   │   ├── dto/               # Data transfer objects
│   │   │   ├── entity/            # JPA entities
│   │   │   ├── mapper/            # DTO/Entity mappers
│   │   │   ├── parser/            # Excel parser
│   │   │   └── service/           # Business logic
│   │   │
│   │   └── resources/
│   │       └── db/migration/
│   │           └── V11__update_batch_id_pattern.sql
│   │
│   └── test/
│       └── resources/
│           └── sample-orders.csv  # Sample CSV template
│
├── package.json                    # Node.js dependencies
└── package-lock.json              # Locked versions

```

## File Purposes

### Documentation (`backend/docs/`)

| File | Purpose |
|------|---------|
| `BULK-UPLOAD-NEXT-STEPS.md` | Phase 3 planning: validation, async processing, UI |
| `MANUAL-TESTING-GUIDE.md` | Complete testing guide with scenarios and expected results |
| `FILE-ORGANIZATION.md` | This file - structure overview |

### Scripts (`backend/scripts/`)

| File | Purpose | Usage |
|------|---------|-------|
| `README.md` | Scripts documentation | Reference guide |
| `generate-test-excel.js` | Creates test Excel files | `npm run generate-test-excel` |
| `test-upload.js` | Tests upload API | `npm run test-upload` |

**Dependencies:**
- `exceljs` 4.4.0 - Excel file generation
- `axios` 1.6.0 - HTTP client for API testing

### Test Data (`backend/test-data/`)

**Gitignored:** All `.xlsx` and `.xls` files are ignored to prevent committing binary test files.

| File | Purpose | Generated By |
|------|---------|--------------|
| `.gitkeep` | Keep directory in git | Manual |
| `test-orders.xlsx` | 3-row test file (REF-001, REF-002, no-ref) | generate-test-excel.js |
| `test-new.xlsx` | Fresh test data | generate-test-excel.js |

### Source Code (`backend/src/`)

**Main Application:**
- `controller/BulkUploadController.java` - REST API endpoint
- `dto/` - Request/response DTOs
- `entity/BulkUploadBatch.java`, `BulkUploadRow.java` - Database entities
- `mapper/BulkOrderMapper.java` - Maps Excel rows to Order DTOs
- `parser/ExcelParserService.java` - Parses Excel files (27 columns)
- `service/BulkUploadService.java` - Orchestrates upload workflow

**Database:**
- `V11__update_batch_id_pattern.sql` - Migration for 16-digit batch IDs

**Test Resources:**
- `sample-orders.csv` - CSV template for reference

## Gitignore Rules

Added to `.gitignore`:
```gitignore
# Test data (generated Excel files)
backend/test-data/*.xlsx
backend/test-data/*.xls
```

**Rationale:** Test Excel files are binary and easily regenerated, so they shouldn't be committed to version control.

## Quick Commands

```bash
# Generate test Excel file
cd backend
npm run generate-test-excel

# Test upload API
npm run test-upload

# Custom filename
npm run generate-test-excel my-test.xlsx
npm run test-upload my-test.xlsx
```

## Dependencies

**Backend (Gradle):**
- Spring Boot 3.3.5
- Apache POI 5.2.5 (Excel parsing)
- PostgreSQL JDBC driver
- Flyway 10.10.0 (migrations)

**Testing (Node.js):**
- exceljs 4.4.0 (Excel generation)
- axios 1.6.0 (HTTP client)

## Notes

1. **Scripts Location:** `backend/scripts/` follows convention for project-specific scripts
2. **Docs Location:** `backend/docs/` keeps backend-specific documentation with the backend code
3. **Test Data:** Separated from source code, easy to regenerate, gitignored
4. **Node.js in Backend:** Testing scripts are development-only, not part of production build

## Related Documentation

- [MANUAL-TESTING-GUIDE.md](./MANUAL-TESTING-GUIDE.md) - Testing procedures
- [BULK-UPLOAD-NEXT-STEPS.md](./BULK-UPLOAD-NEXT-STEPS.md) - Phase 3 planning
- [scripts/README.md](../scripts/README.md) - Scripts usage details

---

**Last Updated:** 2025-10-04  
**Phase:** Phase 1 & 2 Complete ✅
